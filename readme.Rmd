---
title: "Mexico City Pollution Data"
author: "Diego Valle-Jones"
date: "March 18, 2016"
output: 
 github_document:
          toc: true
          fig_width: 8
          fig_height: 5
---

Master: [![Travis-CI Build Status](https://travis-ci.org/diegovalle/aire.zmvm.svg?branch=master)](https://travis-ci.org/diegovalle/aire.zmvm) 

|              |          |
|--------------|---------------|
| __Author:__ | Diego Valle-Jones |
| __License:__ | [BSD_3](https://opensource.org/licenses/BSD-3-Clause) |
| __Status:__ | alpha |
| __Website:__ | [https://github.com/diegovalle/aire.zmvm](https://github.com/diegovalle/aire.zmvm) |


## What does it do?

This package downloads pollution data for the Mexico City metro area. It can download the daily maximum, minimum, or average for each of the pollution measuring stations in the Zona Metropolitana del Valle de Mexico


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Installation

For the moment this package is only available from github. For the development version:

```r
if (!require(devtools)) {
    install.packages("devtools")
}
devtools::install_github('diegovalle/aire.zmvm')
```

## Quick Example

The package mainly consists of two functions: ```get_zone_data``` to download data for each of the 5 geographic zones of Mexico City and ```get_station_data``` to download data for each of the pollution (and wind and temperature) measuring stations.

```{r, fig.show='hold', warning=FALSE}
library("aire.zmvm")
library("dplyr")
library("ggplot2")


years <- 2005:2016
# Download pm10 data for the years 2005:2016
# The type of data can be: MAXIMOS, MINIMOS or HORARIOS (hourly average)
# The type of pollutant can be: "so2", "co", "nox", "no2",
#                               "no", "o3", "pm10", "pm2", "wsp", "wdr", "tmp", "rh"
pm_10 <- get_zone_data("MAXIMOS", "PM10", "TZ", "2008-01-01", "2016-03-19")
# Notice the data.frame already has columns max, min, mean, median
knitr::kable(head(pm_10))


ggplot(pm_10 %>% group_by(date) %>% summarise(max = max(value, na.rm = TRUE)), 
       aes(date, max, group = 1)) +
  geom_line(color = "gray") +
  geom_smooth(method = "gam", formula = y ~ s(x, k = 50)) +
  theme_bw()
```
